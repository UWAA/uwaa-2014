function finishedLoading(){firstLoad&&(loader.className="done",setTimeout(function(){loader.className="hide"},100)),firstLoad=!1}function isSecure(){return"https:"==location.protocol}mapboxgl.accessToken="pk.eyJ1IjoiYnBlcmljayIsImEiOiJrT2xBSUNzIn0.n-CVAwFlqHGqkiDUxsIdSQ";var usCenter=[-100,38],path=window.location.pathname.split("/").filter(function(a){return""!==a}).pop(),map=new mapboxgl.Map({container:"map",style:"mapbox://styles/bperick/ckbh38dq004dl1inqeej0mih0",center:usCenter,zoom:3,renderWorldCopies:!1,fadeDuration:0}),nav=new mapboxgl.NavigationControl({showCompass:!1,showZoom:!0});map.addControl(nav,"top-left");var endPoint=homeLink.endpointURL;map.on("load",function(){map.loadImage("https://a.tiles.mapbox.com/v4/marker/pin-m+4b2e83.png?access_token=pk.eyJ1IjoiYnBlcmljayIsImEiOiJrT2xBSUNzIn0.n-CVAwFlqHGqkiDUxsIdSQ",function(a,b){if(a)throw a;map.addImage("marker",b),map.addSource("communities",{type:"geojson",data:endPoint}),map.addLayer({id:"unclustered-point",type:"symbol",source:"communities",layout:{"icon-image":"marker","icon-size":1,"icon-allow-overlap":!0,"icon-ignore-placement":!0}}),finishedLoading()})});var firstLoad=!0;if(map.on("click","unclustered-point",function(a){map.getCanvas().style.cursor="pointer";var b=map.queryRenderedFeatures(a.point,{layers:["unclustered-point"]}),c=a.features[0].geometry.coordinates.slice();b.map(function(a){var b='<a href="'+a.properties.link+'" data-chapter="'+a.properties.jumper+'"><div class="map-logo '+a.properties.logo+'"></div><p class="map-excerpt">'+a.properties.excerpt+'</a><a class="map-link" href="'+a.properties.link+'"></a></p>';$(b).click(function(){var a=this.dataset.chapter,b=$(".collapse p"),c=b.children("#"+a).parents(".panel"),d=c.find(".indicator:first"),e=c.children(".collapse");c.removeClass("closed").addClass("open"),d.attr("aria-expanded","true"),d.text("Expanded"),d.css({position:"absolute",clip:"rect(1px, 1px, 1px, 1px)"}),e.show().attr("aria-hidden","false"),$("html, body").animate({scrollTop:e.offset().top-100},500)}),new mapboxgl.Popup({closeButton:!0,closeOnClick:!0}).setLngLat(c).setHTML(b).addTo(map)}),map.flyTo({center:c})}),map.on("mouseenter","unclustered-point",function(a){map.getCanvas().style.cursor="pointer"}),map.on("mouseleave","unclustered-point",function(){map.getCanvas().style.cursor=""}),isSecure())var endPoint=endPoint.replace(/^http:\/\//i,"https://");