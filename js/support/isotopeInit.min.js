Isotope=Backbone.View.extend({el:"#isotope-canvas",events:{"click .filter-button":"filterByButton","keyup #quicksearch":"filterBySearch","click .list-button":"listView","click .grid-button":"tileView","click .print-button":"print","click #email-signup":"makeSignupFormFrameVisible","click #iframe-emphasis-background":"closeEmphasizedSignup"},initialize:function(){var a=this.getURLParameterByName("filter"),b=this.getURLParameterByName("lectureSignup"),c=this.getCookie("UWAA_"+document.location.pathname);if(0===a.length&&null!=c){var a=c;history.pushState("UWAAFILTER","","?filter="+a)}$canvas=this.$(".isotope").isotope({itemSelector:".post-thumbnail-slide",layoutMode:"fitRows"});var d="."+a.toLowerCase();$canvas.imagesLoaded(function(){if(""!=a){$canvas.isotope("layout"),$canvas.isotope({filter:d}),isotopeInit.signupFormCheck(d);var c=$('[data-filter="'+d+'"]');c.siblings().removeClass("is-checked"),c.addClass("is-checked")}else $canvas.isotope("layout");"true"===b&&isotopeInit.addSignupFormEmphasis()})},filterByButton:function(a){var b=$(a.target);this.$("#quicksearch").val("");var c=b.attr("data-filter");if(this.$(".isotope").isotope({filter:c}),history.pushState("UWAAFILTER","","?filter="+c.replace(/\./gi,"")),this.toggleButtonClass(b),this.signupFormCheck(c),""===c)return this.eraseCookie("UWAA_"+document.location.pathname),void history.pushState("UWAAFILTER","",document.location.pathname);this.createCookie("UWAA_"+document.location.pathname,c.replace(/\./gi,""),1)},toggleButtonClass:function(a){a.siblings().removeClass("is-checked"),a.addClass("is-checked")},toggleParentButtonClass:function(a){a.parent().siblings().removeClass("is-checked"),a.parent().addClass("is-checked")},filterBySearch:_.debounce(function(){var a=new RegExp(this.$("#quicksearch").val(),"gi");this.$(".isotope").isotope({filter:function(){return!a||$(this).text().match(a)}})},200),listView:function(a){var b=$(a.target);this.$(".isotope").addClass("list").removeClass("tile").isotope({layoutMode:"vertical"}),this.toggleButtonClass(b),this.toggleParentButtonClass(b)},tileView:function(a){var b=$(a.target);this.$(".isotope").addClass("tile").removeClass("list").isotope({layoutMode:"fitRows"}),this.toggleButtonClass(b),this.toggleParentButtonClass(b)},print:function(a){$listButton=$(".list-button"),this.listView(a),_.delay(function(){window.print()},500),this.toggleButtonClass($listButton),this.toggleParentButtonClass($listButton)},getURLParameterByName:function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))},createCookie:function(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3);var e="; expires="+d.toUTCString()}else var e="";document.cookie=a+"="+b+e+"; path=/"},getCookie:function(a){var b="; "+document.cookie,c=b.split("; "+a+"=");return 2==c.length?c.pop().split(";").shift():null},eraseCookie:function(a){this.createCookie(a,"",-1)},signupFormCheck:function(a){switch(a){case".arts-and-lectures":this.makeSignupFormButtonVisible("Lectures");break;default:return this.$("#email-signup").addClass("button-hidden"),void $("#lecture-signup-wrapper").removeClass("iframe-opened")}},makeSignupFormButtonVisible:function(a){this.$("#email-signup > div > span").html(a),this.$("#email-signup").toggleClass("button-hidden")},makeSignupFormFrameVisible:function(){$("#lecture-signup-wrapper").toggleClass("iframe-opened").removeClass("special-emphasis"),$("#email-signup").siblings().toggleClass("invisible"),$("#email-signup").toggleClass("iframe-active"),$("#isotope-search").toggleClass("invisible")},addSignupFormEmphasis:function(){this.makeSignupFormFrameVisible(),$("#lecture-signup-wrapper").addClass("special-emphasis"),$("#iframe-emphasis-background").addClass("signup-has-emphasis")},closeEmphasizedSignup:function(){$("#iframe-emphasis-background").removeClass("signup-has-emphasis"),$("#lecture-signup-wrapper").removeClass("special-emphasis"),this.makeSignupFormFrameVisible()}}),isotopeInit=new Isotope;